# GPub: A Go Publishing Utility

## Overview

_Note: GPub is under active development and users may find unexpected API-breaking
changes until a 1.0.0 release occurs_

GPub is a book-generating platform that relies on [Glift](www.gliftgo.com).
Generally speaking, Glift is responsible for providing an understanding of Go
files and generated a flattened representation of a go position, while GPub is
responsible for generating an intermediate representation and for the ultimate
rendering.

The JavaScript API for book generation is:

```javascript
  gpub.create([sgf1, sgf2, ...], {...options...});
```

This returns the string output of the book.

### Options

Structure of the options object in the API

```javascript
{
  // The goal of book generation.  This specifies how we generate the Glift
  // spec.
  bookPurpose: <gpub.bookPurpose, default='GAME_COMMENTARY'>,

  // The format of the book generated.
  outputFormat: <gpub.outputFormat, default='LATEX'>,

  // The default board region to display.
  boardRegion: <glift.enums.boardRegion, default='AUTO'>,

  // The type of diagrams to generate within the book.
  diagramType: <gpub.diagrams.diagramType, default='GNOS'>,

  // Override the templates
  // A false-y template will resulti in using the default template//
  template: null,

  // Options specificaly for book processors.  These options are generally
  // specified within the template.
  bookOptions: {}
};
```

### Installation

For font-installation instructions, [Kashomon/go-type1](www.github.com/Kashomon/go-type1).  The recommended font is gnos.

_TODO(kashomon): Discuss how to install GPub once it is more stable_

### The Glift Spec

The Glift Spec is an options definition that is consumable by Glift, and is the
intermediate form of the book.  Thus, all specs generated by GPub should be
consumable by Glift directly (modulo the addition of a HTML element ID).

The output of spec-generation is configured by the __`Book Purpose`__ option.
Currently gpub supports two book purposes:

  * `GAME_COMMENTARY`: An SGF that has been processed into examples to display commentary in a book form.
  * `PROBLEM_SET`: A set of problems, used to create a book problems (with or without answers).


###  Book Generation

### A Discussion of Architecture

At the base of GPub is Glift, which provides all the interesting SGF parsing / handling.

GPub deals with a number of data types:

* __SGF__: SGF is the basic file format for Go. It stands for Smart Go Format
  and is meant to record moves, variations, and comments.  SGFs look like `(;GM[1]AW[aa]AB[ab]...)`
* __Glift Spec__: This is the JSON format used by Glift for rendering multiple
  SGFs.  Beyond SGFs, it also contains tertiary data for rendering such as widgetType.
* __LaTeX__: A target book format.
* __Markdown__: Markdown is a text-formatting style used for rendering.
  Typically, the target is HTML, but in the case of GPub, Markdown is used for comments to rendor LaTeX.

Thus, we see the following flow in GPub:

    List of SGFS  => Generate Glift Spec
                  => Generate Book Spec (Optional)
                  => Generate LaTeX
                  => Generate PDF (via pdflatex)

### Open Questions

* Does it make sense to generate an intermediate Book Spec? It works reasonably
  well for games, but it might not make sense for problems.
